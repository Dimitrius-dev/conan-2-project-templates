# Conan-server-project template
___
## Описание
___
Использования сервера Conan 2.0 для хранения библиотек.
___
Сам сервер был помещен в Docker образ для удобства развертывания.

## Подготовка для развертывания
___
1. Создайте Docker ```volume``` для хранения всех накопленных библиотек.
Именно это хранилище будет хранить все пакеты библиотек даже при отсутствии запущенных контейнеров.
Создайте volume с именем ```conan_db``` с помощью команды:
```
docker volume create conan_db
```

## Конфигурирование переменных развертывания
___
Есть два варианта использования docker образа
1. Использование готового образа из ```docker hub```
1. Сборка образа из папки ```conan-server-build```

## Использование образа из ```docker hub``` (папка ```conan-server```)
Создайте файл ```docker-compose.yml``` в любом месте. 
Пример настроек представлен ниже:
```
version: "3"
services:
  conan_server:
    image: dmitriiidev/conan-server:latest
    environment:
      - HOST_NAME=conancustom
      - PORT=9345
      - ROOT_USER_PASSWORD=root
    volumes:
      - conan_db:/data
    ports:
      - "9300:9345"

volumes:
  conan_db:
    external: true
```

С помощью блока ```environment``` можно задать настройки запуска контейнера с сервером.  
```HOST_NAME``` - имя для сервера conan.  
```PORT``` - порт для сервера conan.  
```ROOT_USER_PASSWORD``` - пароль от главного пользователя, который имеет логин ```root```.

С помощью блока ```image``` можно задать используемый образ.  

В блоке ```ports``` можно настройть внешний порт доступа (внешний) контейнера
и порт на который он прокидывается внутри контейнера (внутренний).  
Схема портов ```"[внешний порт]:[внутренний порт]"```, пример: ```"9300:9345"```

## Использование образа из искзодников (папка ```conan-server-src```)
В папке ```conan-server-src``` лежит файл ```docker-compose.yml``` для корректного запуска всех контейнеров.
Установите настройки в ```docker-compose.yml```.

```
version: "3"
services:
  conan_server:
    build: ./conan-server-image
    environment:
      - HOST_NAME=conancustom
      - PORT=9345
      - ROOT_USER_PASSWORD=root
    volumes:
      - conan_db:/data
    ports:
      - "9300:9345"

volumes:
  conan_db:
    external: true
```

С помощью блока ```environment``` можно задать настройки запуска контейнера с сервером.  
```HOST_NAME``` - имя для сервера conan.  
```PORT``` - порт для сервера conan.  
```ROOT_USER_PASSWORD``` - пароль от главного пользователя, который имеет логин ```root```.

С помощью блока ```build``` можно задать путь к Dockerfile для создания образа.  
С помощью блока ```image``` можно задать используемый образ.  

В блоке ```ports``` можно настройть внешний порт доступа (внешний) контейнера
и порт на который он прокидывается внутри контейнера (внутренний).  
Схема портов ```"[внешний порт]:[внутренний порт]"```, пример: ```"9300:9345"```

## Сборка
___
Для корректной сборки перейдите в директорию, в которой расположен файл ```docker-compose.yml```
и запустите создание контейнера из образа командой:
```
docker-compose up
```
Также можно не создавать контейнер, а лишь получить образ с помощью команды:
```
docker-compose build
```